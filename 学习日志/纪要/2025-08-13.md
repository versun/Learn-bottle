# 学习纪要：2025-08-13

**课题：** Bottle 核心流程 - 路由的“注册”阶段

### 实践内容：

1.  创建了 `lesson1.py` 文件。
2.  编写了第一个 Bottle 应用，包含：
    - 一个静态路由 `@route('/')`，返回 "Hello, World!"。
    - 一个动态路由 `@route('/user/<name>')`，可以根据 URL 中的名字返回不同的问候。
3.  成功运行了 Bottle 的内置开发服务器，并通过浏览器访问了创建的页面。

### 核心问题与源码探索：

**问题：** `@route()` 装饰器是如何将一个 URL 和一个 Python 函数关联起来的？

**源码追踪路径：**

1.  **`@route(...)`**: 本质是调用 `Bottle.route()` 方法。
2.  **`Bottle.route()`**: 该方法返回一个内部的 `decorator(callback)` 函数。
3.  **`decorator(callback)`**: 这是装饰器的核心实现。它将路径、HTTP 方法和被装饰的函数（`callback`）打包成一个 `Route` 对象。
4.  **`self.add_route(route)`**: `decorator` 函数内部调用此方法来注册 `Route` 对象。
5.  **`self.router.add(...)`**: 在 `add_route` 方法中，最终调用了 `Router` 对象的 `add` 方法，完成了路由规则的最终登记。

### 今日结论：

我们清晰地理解了 Bottle 路由的“注册阶段”。`@route()` 的作用并非在请求时才匹配，而是在程序加载时就将所有路由信息收集起来，并结构化地存储在 `Router` 对象中，为后续的“匹配阶段”做好了准备。
